# 素食推廣網站 - 啟動說明

## ✅ 問題已修復

兩個問題都已經解決：
1. ✅ 表單提交功能正常運作
2. ✅ 統計頁面正常顯示

## 🚀 如何啟動專案

### 需要開啟兩個終端

**終端 1 - 啟動 API 伺服器（處理表單和資料）：**
```bash
npm run server
```
應該會看到：
```
✅ CSV API Server running on http://localhost:8000
📁 CSV file: ...\api\survey_data.csv
📁 Public CSV file: ...\public\api\survey_data.csv
```

**終端 2 - 啟動前端開發伺服器（已經在運行）：**
```bash
npm run dev
```
應該會看到：
```
➜  Local:   http://localhost:5173/
```

### 訪問網站
瀏覽器開啟：**http://localhost:5173/**

## 📋 功能測試

### 1. 測試表單提交
1. 在網站上導航到表單頁面
2. 填寫所有必填欄位：
   - 姓名
   - 性別
   - 國家
   - 是否素食
   - 素食承諾時長
3. 點擊提交
4. 應該會看到「提交成功」的訊息
5. 資料會自動儲存到 `api/survey_data.csv`

### 2. 測試統計頁面
1. 導航到統計頁面（Current Stats）
2. 應該能看到：
   - 各國家的統計資料
   - 各素食時長的統計
   - 總人數
   - 總餐數

## 🔧 技術架構

### 資料流程
```
用戶填寫表單
    ↓
提交到 /api/save_to_csv.php
    ↓
Node.js Express 伺服器（port 8000）
    ↓
儲存到 CSV 檔案
    ├─ api/survey_data.csv（主檔案）
    └─ public/api/survey_data.csv（公開檔案）
    ↓
統計頁面讀取資料
    ├─ GET /api/get_survey_data.php（國家統計）
    └─ GET /api/get_time_stats.php（時間統計）
```

### 使用的技術
- **前端**：React + Vite（port 5173）
- **API 伺服器**：Node.js + Express（port 8000）
- **資料儲存**：CSV 檔案
- **代理**：Vite 代理 `/api` 請求到 port 8000

## 📁 重要檔案

- `server.js` - Node.js API 伺服器
- `api/survey_data.csv` - 主要資料檔案
- `public/api/survey_data.csv` - 公開資料檔案（備份）
- `vite.config.js` - Vite 配置（包含 API 代理設定）

## ⚠️ 注意事項

1. **兩個伺服器都必須運行**
   - API 伺服器（port 8000）：處理表單提交
   - Vite 開發伺服器（port 5173）：前端應用

2. **不要關閉終端**
   - 兩個終端都需要保持運行狀態

3. **CSV 檔案**
   - 資料會自動附加到檔案末尾
   - 建議定期備份 `api/survey_data.csv`

## 🐛 疑難排解

### 表單提交失敗
**症狀**：點擊提交後顯示錯誤
**解決**：確認 API 伺服器正在運行
```bash
# 檢查是否有輸出
npm run server
```

### 統計頁面空白
**症狀**：統計頁面沒有顯示資料
**解決**：
1. 確認 API 伺服器正在運行
2. 檢查 `api/survey_data.csv` 是否有資料
3. 查看瀏覽器控制台是否有錯誤訊息

### Port 已被占用
**症狀**：啟動伺服器時顯示 port 錯誤
**解決**：
```bash
# Windows
netstat -ano | findstr :8000
taskkill /PID <PID> /F

# 或修改 server.js 的 PORT 值
```

## ✨ 測試資料

目前 CSV 檔案包含 6 筆測試資料：
- Taiwan: 2 人
- Japan: 2 人
- United States: 1 人
- Singapore: 1 人

您可以透過表單提交新增更多資料，或直接編輯 CSV 檔案。

## 🎉 完成

兩個問題都已解決，您現在可以：
1. ✅ 正常提交表單
2. ✅ 查看即時更新的統計資料

祝使用愉快！
