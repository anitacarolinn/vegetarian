# 統計頁面診斷指南

## ✅ 已確認正常運作

1. ✅ API 伺服器正在運行 (port 8000)
2. ✅ 國家統計 API 正常返回資料
3. ✅ 時間統計 API 正常返回資料
4. ✅ Vite 代理正常運作
5. ✅ CSV 檔案包含 7 筆資料

## 📊 目前資料狀態

**國家統計：**
- Taiwan: 2 人
- Japan: 2 人
- United States: 1 人
- Singapore: 1 人
- Syrian Arab Republic: 1 人
- **總計：7 人**

**時間統計：**
- 茹素一天：1 人
- 茹素一週一天：1 人
- 茹素一個月：1 人
- 茹素一年：2 人
- 一生一世茹素：1 人
- 生生世世茹素：1 人
- **總餐數：4,629 餐**

## 🔍 如何訪問統計頁面

### 正確的網址：

根據語言選擇不同的路徑：

1. **繁體中文**：`http://localhost:5173/currentstats`
2. **英文**：`http://localhost:5173/en/currentstats`
3. **西班牙文**：`http://localhost:5173/es/currentstats`

### 從主頁導航：

1. 開啟 `http://localhost:5173/`
2. 點擊頁面上方的 **「發願人數」** 或 **「vownum-btn」** 按鈕
3. 應該會自動跳轉到統計頁面

## 🛠️ 問題診斷步驟

### 步驟 1：確認伺服器運行

開啟兩個終端，確認都在運行：

**終端 1 - API 伺服器：**
```bash
npm run server
```
應該看到：
```
✅ CSV API Server running on http://localhost:8000
```

**終端 2 - 前端伺服器：**
```bash
npm run dev
```
應該看到：
```
➜  Local:   http://localhost:5173/
```

### 步驟 2：測試 API 端點

在瀏覽器開啟以下網址，應該能看到 JSON 資料：

1. **測試國家統計：**
   ```
   http://localhost:5173/api/get_survey_data.php
   ```
   應該顯示：
   ```json
   {"country_data":[...],"total_count":7}
   ```

2. **測試時間統計：**
   ```
   http://localhost:5173/api/get_time_stats.php
   ```
   應該顯示：
   ```json
   {"time_stats":{...},"total_meals":4629}
   ```

### 步驟 3：檢查瀏覽器控制台

1. 訪問 `http://localhost:5173/currentstats`
2. 按 `F12` 開啟開發者工具
3. 切換到 **Console** 標籤
4. 查看是否有紅色錯誤訊息
5. 切換到 **Network** 標籤
6. 重新整理頁面
7. 檢查是否有失敗的 API 請求（顯示紅色）

### 步驟 4：檢查頁面顯示

統計頁面應該包含以下元素：

1. ✅ 慈濟 Logo
2. ✅ 「回首頁」按鈕
3. ✅ 總目標進度顯示
4. ✅ 各項素食時長統計
5. ✅ 發願總人數
6. ✅ 累積發願茹素餐數
7. ✅ 國家列表（底部）

## 🐛 常見問題解決

### 問題 1：頁面完全空白

**原因：**可能是 API 伺服器未運行

**解決：**
```bash
# 檢查是否有 Node.js 進程在 port 8000
netstat -ano | findstr :8000

# 如果沒有，啟動 API 伺服器
npm run server
```

### 問題 2：顯示「Chart placeholder」

**原因：**這是正常的，因為地圖圖表功能尚未實作

**說明：**資料列表會顯示在頁面底部

### 問題 3：數字都顯示 0

**原因：**API 請求失敗或 CSV 檔案為空

**解決：**
1. 檢查 API 伺服器是否運行
2. 檢查 `api/survey_data.csv` 是否有資料
3. 嘗試提交一筆表單測試資料

### 問題 4：看到 404 錯誤

**原因：**網址錯誤

**解決：**確認使用正確的網址：
- ✅ 正確：`http://localhost:5173/currentstats`
- ❌ 錯誤：`http://localhost:5173/current-stats`
- ❌ 錯誤：`http://localhost:5173/stats`

### 問題 5：數據不更新

**原因：**瀏覽器快取

**解決：**
1. 按 `Ctrl + F5` 強制重新整理
2. 或清除瀏覽器快取

## 🧪 快速測試

在命令列執行以下指令測試所有功能：

```bash
# 測試 1：檢查 API 伺服器
curl http://localhost:5173/api/get_survey_data.php

# 測試 2：檢查時間統計
curl http://localhost:5173/api/get_time_stats.php

# 測試 3：提交測試資料
curl -X POST http://localhost:5173/api/save_to_csv.php -H "Content-Type: application/json" -d "{\"name\":\"測試用戶\",\"gender\":\"male\",\"country\":\"Taiwan\",\"isVegetarian\":\"yes\",\"vegetarianTime\":\"1-year\"}"
```

如果這三個測試都成功，統計頁面應該就能正常顯示！

## 📞 還是無法顯示？

請告訴我您看到的具體情況：

1. 頁面是完全空白，還是有部分內容？
2. 瀏覽器控制台有什麼錯誤訊息？
3. Network 標籤中 API 請求的狀態碼是什麼？
4. 您訪問的完整網址是什麼？

提供這些資訊後，我可以更精確地幫您診斷問題！
